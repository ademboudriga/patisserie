<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Re√ßu - P√¢tisserie MOKA</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @page {
      margin: 20mm;
    }

    @media print {
      body {
        -webkit-print-color-adjust: exact;
      }

      @page {
        size: auto;
        margin: 0;
      }

      /* Masquer les boutons dans la version imprim√©e */
      .no-print {
        display: none !important;
      }
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-6">
  <div class="bg-white shadow-lg rounded-2xl p-8 w-full max-w-2xl border border-gray-200">
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-pink-600">P√¢tisserie MOKA</h1>
      <p class="text-gray-700">34 avenue Habib Bougatfa</p>
      <p class="text-gray-700">T√©l√©phone : 24066434</p>
      <hr class="my-4 border-gray-300" />
      <h2 class="text-2xl font-semibold text-gray-800">Re√ßu de Commande</h2>
    </div>

    <div id="recu-content" class="space-y-3 text-gray-700">
      <p><strong>Client :</strong> <span id="nomClient"></span> <span id="prenomClient"></span></p>
      <p><strong>T√©l√©phone :</strong> <span id="telephone"></span></p>
      <p><strong>Dimensions :</strong> <span id="dimensions"></span></p>
      <p><strong>√âtages :</strong> <span id="etages"></span></p>
      <p><strong>Prix Total :</strong> <span id="prix"></span> DT</p>
      <p><strong>Accompte :</strong> <span id="accompte"></span> DT</p>
      <p><strong>Date de Livraison :</strong> <span id="dateLivraison"></span></p>
      <p><strong>Description :</strong> <span id="description"></span></p>
    </div>

    <div class="mt-8 flex justify-center gap-4 no-print">
      <button onclick="window.print()" class="bg-pink-600 text-white px-6 py-2 rounded-lg hover:bg-pink-700 transition">
        üñ®Ô∏è Imprimer
      </button>
      <button onclick="window.close()" class="bg-gray-400 text-white px-6 py-2 rounded-lg hover:bg-gray-500 transition">
        ‚ùå Fermer
      </button>
    </div>
  </div>

  <script>
    // üîπ R√©cup√©ration des param√®tres depuis l'URL
    const params = new URLSearchParams(window.location.search);

    // üîπ Gestion propre de la date de livraison
    let dateLivraisonRaw = params.get('date_livraison') || '';
    let dateLivraisonFormatted = '';

    if (dateLivraisonRaw) {
      // Supprimer l‚Äôheure si pr√©sente (ex: "2025-10-25T00:00:00.000Z" ‚Üí "2025-10-25")
      if (dateLivraisonRaw.includes('T')) {
        dateLivraisonRaw = dateLivraisonRaw.split('T')[0];
      }

      const dateObj = new Date(dateLivraisonRaw);
      if (!isNaN(dateObj.getTime())) {
        // Formater la date au format fran√ßais JJ/MM/AAAA
        dateLivraisonFormatted = dateObj.toLocaleDateString('fr-FR');
      } else {
        dateLivraisonFormatted = dateLivraisonRaw;
      }
    }

    // üîπ Injection des valeurs dans le re√ßu
    document.getElementById('nomClient').textContent = params.get('nom_client') || '';
    document.getElementById('prenomClient').textContent = params.get('prenom_client') || '';
    document.getElementById('telephone').textContent = params.get('telephone') || '';
    document.getElementById('dimensions').textContent = `${params.get('longueur') || ''} x ${params.get('largeur') || ''} cm`;
    document.getElementById('etages').textContent = params.get('nombre_etages') || '';
    document.getElementById('prix').textContent = parseFloat(params.get('prix') || 0).toFixed(2);
    document.getElementById('accompte').textContent = parseFloat(params.get('accompte') || 0).toFixed(2);
    document.getElementById('dateLivraison').textContent = dateLivraisonFormatted;
    document.getElementById('description').textContent = params.get('description') || '';
  </script>
</body>
</html>
